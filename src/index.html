<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ç®€å•éŸ³ä¹æ’­æ”¾å™¨</title>
        <link rel="stylesheet" href="./js/styles.css" />
        <script src="./js/jquery-3.7.1.min.js"></script>
    </head>
    <body>
        <h3 id="audio-title" class="box">ç®€å•éŸ³ä¹æ’­æ”¾å™¨</h3>
        <div class="box audio-wrapper">
            <div class="audio-control-container">
                <audio id="audio">
                    <source id="audio-source" src="" />
                    ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³ä¹æ’­æ”¾åŠŸèƒ½
                </audio>
                <span id="audio-timestamp">0:00 / 0:00</span>
                <div id="audio-progress-container">
                    <div id="audio-progress-bar"></div>
                </div>
                <input
                    type="button"
                    value="ğŸ”"
                    id="audio-play-mode"
                    title="é¡ºåºã€éšæœºæ’­æ”¾"
                />
                <input
                    type="button"
                    value="â®"
                    id="audio-prev-track"
                    title="æ’­æ”¾ä¸Šä¸€é¦–æ­Œæ›²"
                />
                <input
                    type="button"
                    value="â–¶"
                    id="audio-start-pause"
                    title="æ’­æ”¾ã€æš‚åœ"
                />
                <input
                    type="button"
                    value="â­"
                    id="audio-next-track"
                    title="æ’­æ”¾ä¸‹ä¸€é¦–æ­Œæ›²"
                />
            </div>
        </div>
        <div class="box pages-header-bottom">
            <span id="utils-status"></span>
            <div class="pages-header">
                <button id="pages-btn-lib" class="active">åº“</button>
                <button id="pages-btn-playlist">åˆ—è¡¨</button>
            </div>
        </div>
        <div id="pages-div-playlist" class="pages-div">
            <div class="box wrap" id="playlist-dirs"></div>
            <div class="box wrap">
                <ul id="playlist-music-list"></ul>
            </div>
            <div class="box hcenter">
                <div class="pager wrap" id="playlist-pager-container"></div>
            </div>
        </div>
        <div id="pages-div-lib" class="pages-div active">
            <div class="box">
                <input
                    type="button"
                    value="âŒ"
                    id="lib-clear"
                    title="æ¸…ç©ºæœç´¢å…³é”®è¯"
                />
                <input
                    type="text"
                    id="lib-search-box"
                    placeholder="æœç´¢æ­Œæ›²..."
                />
                <input
                    type="button"
                    value="ğŸ”„"
                    id="lib-update-db"
                    title="æ›´æ–°æ•°æ®åº“"
                />
            </div>
            <div class="box">
                <ul id="lib-music-list">
                    <!-- æ­Œæ›²åˆ—è¡¨å°†ç”± JavaScript åŠ¨æ€ç”Ÿæˆ -->
                </ul>
            </div>
            <div class="box hcenter">
                <div class="pager wrap" id="lib-pager-container"></div>
            </div>
        </div>
    </body>
    <script type="module">
        import Utils from "./js/utils.js"
        import Player from "./js/player.js"
        import Database from "./js/database.js"
        import LibList from "./js/lib-list.js"
        import Pages from "./js/pages.js"
        import PlayList from "./js/play-list.js"

        window.utils = new Utils()
        const pages = new Pages()
        pages.init()

        const db = new Database()
        const player = new Player(db)
        const playList = new PlayList(db, player)
        const libList = new LibList(db, player, playList)

        if (db.getAllMusic().length < 1) {
            await db.updateMusicDbAsync()
        }

        playList.refresh()
        libList.doSearch()
    </script>
</html>
